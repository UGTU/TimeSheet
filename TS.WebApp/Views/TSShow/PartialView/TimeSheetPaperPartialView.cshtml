@model TimeSheetMvc4WebApplication.Models.PaperModel

<table id=@Html.Raw(Json.Encode(@Model.id)) border="2" bordercolor="black" cellpadding="0" cellspacing="0" style="border-collapse: collapse; table-layout: auto; font-size: 8.5pt;">
    @Html.Partial("PartialView\\TimeSheetHeader", Model.HeaderStyle)
    
    @foreach (var employee in Model.Employees)
    {
        @Html.Partial("PartialView\\TimeSheetEmployeePartialView", employee)
    }
</table>
@if (Model.IsLast)
    {@Html.Partial("PartialView\\ApproverListPartialView", Model.Approvers)}
<script type="text/javascript">
    var elements = document.getElementsByClassName('chisla');
    for (var i = 0; i < elements.length; i++) {
        elements[i].colSpan = @Model.HeaderStyle.Count(f=>f.DayText != "Х")+2;
    }
    var nums = document.getElementsByClassName('number');
    for (var i = 0; i < nums.length; i++) {
        nums[i].colSpan = @Model.HeaderStyle.Count(f=>f.DayText != "Х")-15;
    }

    var el = document.getElementById(@Html.Raw(Json.Encode(@Model.id))).getElementsByClassName('holidays');
    for (var i = 0; i < el.length; i++) {
        el[i].style.visibility = @Html.Raw(Json.Encode(@Model.DisplayWithHours));
    }
</script> 
<div class="paperNum">
    @Html.Partial("PartialView\\PaperFooter", Model)
</div>



